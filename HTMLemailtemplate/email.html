<!DOCTYPE html>
<html>
<head>
    <title>Email Template</title>
    <script src="https://cdn.jsdelivr.net/npm/handlebars@4.7.8/dist/cjs/handlebars.min.js"></script>
</head>
<body>
    <style>
        .bold-red {
            color: red;
            font-weight: bold;
        }
    </style>

    <!-- FILEPATH: /Ubuntu-22.04/home/lekim/Developer/mdGit/petShop/HTMLemailtemplate/email.html -->
    <img src="header.png" alt="Image Example">
    <p>Dear {{purchase.customerName}},</p>

    <p>We are contacting you because there is an amount due on your <span class="bold-red">purchase</span></p>

    <p><span class="bold-red">Purchase ID: {{purchase.id}}</span>:</p>

    <p>According to our records, the amount due is <span class="bold-red">{{purchase.amountDue}} Kn</span>. Please click on the next button to pay this difference:</p>

    <!-- Button to Pay Now -->
    <!-- Assuming you have a URL stored in your data for the checkout page -->
    <p><a href="{{checkoutUrl}}" target="_blank" style="background-color: red; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px;">PAY NOW</a></p>

    <p>If you have any other concerns please contact our technical support team.</p>

    <p>Kind regards,</p>

    <p>Petson Team</p>
    <script id="orders-template" type="text/x-handlebars-template">
        {{#each orders}}
            <div class="orders-container">
                <h2>Order ID: {{id}}</h2>
                <p>Amount Due: {{amountDue}}</p>
            </div>
        {{/each}}
    </script>
</body>
<script>
    // Fetch orders from the API
    fetch('https://pet-shop.buckhill.com.hr/api/v1/orders', {
        method: 'GET',
        headers: {
            'Content-Type': 'application/json',
            // Include any necessary API keys or tokens here
        }
    })
    .then(response => response.json())
    .then(data => {
        // Assuming the API returns an object with an `orders` array
        const orders = data.orders;
        renderOrders(orders);
    })
    .catch(error => console.error('Error fetching orders:', error));

    function renderOrders(orders) {
        // Get the template from the HTML document
        const templateSource = document.getElementById('orders-template').innerHTML;
        const template = Handlebars.compile(templateSource);

        // Pass the orders data to the template
        const compiledHtml = template({orders});

        // Insert the compiled HTML into the DOM
        document.getElementById('orders-container').innerHTML = compiledHtml;
    }
</script>
</html>